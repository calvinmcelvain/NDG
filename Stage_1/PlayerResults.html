{{ block title }}

<header style="font-size: 21px;">Stage 1: End of Round {{ player.round_number }}</header>
{{ if player.role == C.Player1_ROLE }}
<p style="font-size: 30px;" align="center"> You are <span style="color: red"> {{ player.role }} </span></p>
{{ else }}
<p style="font-size: 30px;" align="center"> You are <span style="color: blue"> {{ player.role }} </span></p>
{{ endif }}

{{ endblock }}

{{ block content }}
{{ if player.role == C.Player1_ROLE }}
<div class="form-group required">
    <table align="center">
        <tr>
            <td colspan="3" ></td>
            <th colspan="2" height="60px" style="text-align: center;"><u>Feedback</u></th>
        </tr>
        <tr>
            <th colspan="3" rowspan="2" style="border: 0;"></th>
            <th colspan="2" height="50px" style="color: blue; border: 0; text-align: center; font-size: 16px;">Player 2</th>
        </tr>
        <tr>
            <th width="50px" style="border: 0; text-align: center; vertical-align: middle;">C</th>
            <th width="50px" style="border: 0; text-align: center; vertical-align: middle;">D</th>
        </tr>
        <tr>
            <th colspan="2" rowspan="2" width="100px" style="border: 0; color: red; text-align: center; vertical-align: middle; font-size: 16px;">Player 1</th>
            <th width="50px" style="border: 0; text-align: center; vertical-align: middle;">A</th>
            <td height="75px" width="100px" style="position: relative; border: 1px solid black; font-weight: bold; font-size: 20px; {{ if player.decision == 'A' and player.other.decision == 'C' }} background-color: yellow {{ endif }}">
                <span style="position: absolute; bottom: 0; left: 0; color: red;">{{C.payoff_AC}}</span>
                <span style="position: absolute; top: 0; right: 0; color: blue;">{{C.payoff_AC}}</span>
            </td>
            <td height="75px" width="100px" style="position: relative; border: 1px solid black; font-weight: bold; font-size: 20px; {{ if player.decision == 'A' and player.other.decision == 'D' }} background-color: yellow {{ endif }}">
                <span style="position: absolute; bottom: 0; left: 0; color: red;">{{C.payoff_low}}</span>
                <span style="position: absolute; top: 0; right: 0; color: blue;">{{C.payoff_high}}</span>
            </td>
        </tr>
        <tr>
            <th width="50px" style="border: 0; text-align: center; vertical-align: middle;">B</th>
            <td height="75px" width="100px" style="position: relative; border: 1px solid black; font-weight: bold; font-size: 20px; {{ if player.decision == 'B' and player.other.decision == 'C' }} background-color: yellow {{ endif }}">
                <span style="position: absolute; bottom: 0; left: 0; color: red;">{{C.payoff_high}}</span>
                <span style="position: absolute; top: 0; right: 0; color: blue;">{{C.payoff_low}}</span>
            </td>
            <td height="75px" width="100px" style="position: relative; border: 1px solid black; font-weight: bold; font-size: 20px; {{ if player.decision == 'B' and player.other.decision == 'D' }} background-color: yellow {{ endif }}">
                <span style="position: absolute; bottom: 0; left: 0; color: red;">{{C.payoff_BD}}</span>
                <span style="position: absolute; top: 0; right: 0; color: blue;">{{C.payoff_BD}}</span>
            </td>
        </tr>
    </table>
</div>
{{ else }}
<div class="form-group required">
    <table align="center">
        <tr>
            <td colspan="3" ></td>
            <th colspan="2" height="60px" style="text-align: center;"><u>Feedback</u></th>
        </tr>
        <tr>
            <th colspan="3" rowspan="2" style="border: 0;"></th>
            <th colspan="2" height="50px" style="color: blue; border: 0; text-align: center; font-size: 16px;">Player 2</th>
        </tr>
        <tr>
            <th width="50px" style="border: 0; text-align: center; vertical-align: middle;">C</th>
            <th width="50px" style="border: 0; text-align: center; vertical-align: middle;">D</th>
        </tr>
        <tr>
            <th colspan="2" rowspan="2" width="100px" style="border: 0; color: red; text-align: center; vertical-align: middle; font-size: 16px;">Player 1</th>
            <th width="50px" style="border: 0; text-align: center; vertical-align: middle;">A</th>
            <td height="75px" width="100px" style="position: relative; border: 1px solid black; font-weight: bold; font-size: 20px; {{ if player.decision == 'C' and player.other.decision == 'A' }} background-color: yellow {{ endif }}">
                <span style="position: absolute; bottom: 0; left: 0; color: red;">{{C.payoff_AC}}</span>
                <span style="position: absolute; top: 0; right: 0; color: blue;">{{C.payoff_AC}}</span>
            </td>
            <td height="75px" width="100px" style="position: relative; border: 1px solid black; font-weight: bold; font-size: 20px; {{ if player.decision == 'D' and player.other.decision == 'A' }} background-color: yellow {{ endif }}">
                <span style="position: absolute; bottom: 0; left: 0; color: red;">{{C.payoff_low}}</span>
                <span style="position: absolute; top: 0; right: 0; color: blue;">{{C.payoff_high}}</span>
            </td>
        </tr>
        <tr>
            <th width="50px" style="border: 0; text-align: center; vertical-align: middle;">B</th>
            <td height="75px" width="100px" style="position: relative; border: 1px solid black; font-weight: bold; font-size: 20px; {{ if player.decision == 'C' and player.other.decision == 'B' }} background-color: yellow {{ endif }}">
                <span style="position: absolute; bottom: 0; left: 0; color: red;">{{C.payoff_high}}</span>
                <span style="position: absolute; top: 0; right: 0; color: blue;">{{C.payoff_low}}</span>
            </td>
            <td height="75px" width="100px" style="position: relative; border: 1px solid black; font-weight: bold; font-size: 20px; {{ if player.decision == 'D' and player.other.decision == 'B' }} background-color: yellow {{ endif }}">
                <span style="position: absolute; bottom: 0; left: 0; color: red;">{{C.payoff_BD}}</span>
                <span style="position: absolute; top: 0; right: 0; color: blue;">{{C.payoff_BD}}</span>
            </td>
        </tr>
    </table>
</div>
{{ endif }}
<div style="margin: 125px">
</div>
<div>
    <table align="center" border="1px solid black" width="1000px">
        <tr style="border: 1px solid black;">
            <th style="border: 1px solid black" align="center">Stage</th>
            <th style="border: 1px solid black" align="center">Round</th>
            <th style="border: 1px solid black" align="center">Your Choice</th>
            <th style="border: 1px solid black" align="center">Other's Choice</th>
            <th style="border: 1px solid black" align="center">Your Payoff</th>
            <th style="border: 1px solid black" align="center">Other's Payoff</th>
            <th style="border: 1px solid black" align="center">Your Accumulated Payoff</th>
        </tr>
        {{ for p in history }}
        <tr style="border: 1px solid black;">
            <td align="center"> {{ p.Stage }} </td>
            <td align="center"> {{ p.round_number }} </td>
            <td align="center"> {{ p.decision }} </td>
            <td align="center"> {{ p.other.decision }} </td>
            <td align="center"> {{ p.payoff }} </td>
            <td align="center"> {{ p.other.payoff }} </td>
            <td align="center"> {{ p.total_payoff }} </td>
        </tr>
        {{ endfor }}
    </table>
</div>
<div style="margin: 50px">
</div>
<div align="right">
    {{ next_button }}
</div>

{{ endblock }}


